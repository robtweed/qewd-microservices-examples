module.exports = function(messageObj, session, send, finished) {
  if (!session.authenticated) {
    return finished({error: 'Not authenticated'});
  }

  if (!messageObj.params) {
    return finished({error: 'No params present in request'});
  }
  let id = messageObj.params.id;
   if (!id || id === '') {
    return finished({error: 'id not defined in request'});
  }

  let db = this.db.dbx;
  let person = db.classmethod('User.Person', '%OpenId', id);
  if (person === '') {
    return finished({error: 'No record exists with that id'});
  }

  person.method('%Close');
  db.classmethod('User.Person', '%DeleteId', id);

  finished({ok: true});
};